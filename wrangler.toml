# ================================================================
# Elegant La Vie — Wrangler Configuration
# Pakistani Perfume Store | Cloudflare Workers + D1
# ================================================================

name               = "elegant-la-vie-api"
main               = "src/worker.js"
compatibility_date = "2024-09-23"

# No Node.js compat flag — we only use Web-standard APIs
# (fetch, crypto.subtle, URL, TextEncoder — all native on Cloudflare Edge)

# ── D1 Database ──────────────────────────────────────────────────
[[d1_databases]]
binding       = "DB"                   # c.env.DB inside worker.js
database_name = "elegant-la-vie-db"   # exact name used in wrangler d1 create
database_id   = "PASTE_YOUR_D1_ID_HERE"
# ↑ Run: wrangler d1 create elegant-la-vie-db
#   Copy the database_id from the output and paste it above.

# ── Non-secret environment variables ─────────────────────────────
[vars]
STORE_NAME = "Elegant La Vie"

# ── Secrets (NEVER commit real values — set via CLI) ─────────────
#
#   wrangler secret put JWT_SECRET
#   → Paste a random 40+ char string (openssl rand -hex 32)
#
#   wrangler secret put WHATSAPP_NUMBER
#   → Your WhatsApp Business number WITHOUT + or spaces
#   → Example: 923001234567   for   +92 300 1234567
#

# ── Local development ─────────────────────────────────────────────
[dev]
port           = 8787
local_protocol = "http"

# Create .dev.vars in your project root (add to .gitignore):
# ┌────────────────────────────────────────────────────────────────
# │ JWT_SECRET=any-local-dev-string-at-least-32-chars
# │ WHATSAPP_NUMBER=923001234567
# │ STORE_NAME=Elegant La Vie
# └────────────────────────────────────────────────────────────────

# ── Production environment override ──────────────────────────────
[env.production]
name = "elegant-la-vie-api-prod"

[[env.production.d1_databases]]
binding       = "DB"
database_name = "elegant-la-vie-db"
database_id   = "PASTE_YOUR_D1_ID_HERE"

# ── Optional: custom domain routing ──────────────────────────────
# Uncomment once you have a domain pointed at Cloudflare:
#
# routes = [
#   { pattern = "api.elegantlavie.pk/*", zone_name = "elegantlavie.pk" }
# ]
